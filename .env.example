# =============================================================================
# Stack AI Local Mejorado con Cloudflare - Variables de Entorno
# =============================================================================
# Copia este archivo como .env y configura los valores según tus necesidades
#
# Modos disponibles:
# - local: Solo servicios básicos con puertos en localhost
# - caddy: Servicios + Caddy con SSL automático
# - cloudflare: Servicios + Cloudflare Tunnel
# - full: Caddy + Cloudflare para máxima flexibilidad
# =============================================================================

# -----------------------------------------------------------------------------
# CONFIGURACIÓN BÁSICA (Requerida para todos los modos)
# -----------------------------------------------------------------------------

# Contraseñas y secretos principales
POSTGRES_PASSWORD=your_secure_postgres_password_here
POSTGRES_DB=postgres
POSTGRES_USER=postgres
JWT_SECRET=your_super_secret_jwt_token_with_at_least_32_characters
ANON_KEY=your_anon_key_here
SERVICE_ROLE_KEY=your_service_role_key_here

# Claves de API
OPENAI_API_KEY=sk-your_openai_api_key_here
ANTHROPIC_API_KEY=sk-ant-your_anthropic_api_key_here

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE SERVICIOS ESPECÍFICOS
# -----------------------------------------------------------------------------

# n8n - Workflow Automation
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=your_n8n_password_here
N8N_HOST=localhost
N8N_PORT=5678
N8N_PROTOCOL=http

# Open WebUI - Chat Interface
OPENWEBUI_NAME=Stack AI Local
OPENWEBUI_SECRET_KEY=your_openwebui_secret_key_here

# Flowise - AI Agent Builder
FLOWISE_USERNAME=admin
FLOWISE_PASSWORD=your_flowise_password_here
FLOWISE_SECRETKEY_OVERWRITE=your_flowise_secret_key_here
FLOWISE_FILE_SIZE_LIMIT=50mb

# Qdrant - Vector Database
QDRANT_API_KEY=your_qdrant_api_key_here

# SearXNG - Private Search Engine
SEARXNG_SECRET_KEY=your_searxng_secret_key_here

# Redis/Valkey - Caching and Queues
REDIS_PASSWORD=your_redis_password_here

# -----------------------------------------------------------------------------
# CONFIGURACIÓN PARA MODO CADDY (caddy, full)
# -----------------------------------------------------------------------------

# Tu dominio para SSL automático
CLOUDFLARE_DOMAIN=tudominio.com

# Email para certificados Let's Encrypt
LETSENCRYPT_EMAIL=tu@email.com

# Configuración adicional de Caddy
CADDY_ADMIN_LISTEN=:2019

# -----------------------------------------------------------------------------
# CONFIGURACIÓN PARA MODO CLOUDFLARE (cloudflare, full)
# -----------------------------------------------------------------------------

# Token del tunnel de Cloudflare (OBLIGATORIO para modo cloudflare)
TUNNEL_TOKEN=tu_token_de_cloudflare_tunnel_aqui

# ID del tunnel (opcional, se lee desde config.yml)
TUNNEL_ID=tu_tunnel_id_aqui

# Configuración de logging para Cloudflare
TUNNEL_LOGLEVEL=info

# -----------------------------------------------------------------------------
# CONFIGURACIÓN AVANZADA DE SUPABASE
# -----------------------------------------------------------------------------

# URLs y configuración interna
SUPABASE_URL=http://localhost:8000
SUPABASE_ANON_KEY=${ANON_KEY}
SUPABASE_SERVICE_ROLE_KEY=${SERVICE_ROLE_KEY}

# Auth configuración
SITE_URL=http://localhost:3000
ADDITIONAL_REDIRECT_URLS=
JWT_EXPIRY=3600
DISABLE_SIGNUP=false
API_EXTERNAL_URL=http://localhost:8000

# Database
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Auth providers (configura solo los que uses)
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
ENABLE_PHONE_SIGNUP=true
ENABLE_PHONE_AUTOCONFIRM=true

# OAuth (opcional)
GITHUB_CLIENT_ID=
GITHUB_SECRET=
GOOGLE_CLIENT_ID=
GOOGLE_SECRET=

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE RED Y PUERTOS (Modo local)
# -----------------------------------------------------------------------------

# Puertos expuestos localmente (solo modo local)
N8N_PORT_EXTERNAL=5678
OPENWEBUI_PORT_EXTERNAL=3000
FLOWISE_PORT_EXTERNAL=3001
QDRANT_PORT_EXTERNAL=6333
SUPABASE_PORT_EXTERNAL=8000
SEARXNG_PORT_EXTERNAL=8080
POSTGRES_PORT_EXTERNAL=5432
REDIS_PORT_EXTERNAL=6379

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE DESARROLLO
# -----------------------------------------------------------------------------

# Variables para desarrollo
NODE_ENV=production
DEBUG=false
LOG_LEVEL=info

# Timezone
TZ=America/Mexico_City

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE SEGURIDAD
# -----------------------------------------------------------------------------

# Configuración adicional de seguridad
ENABLE_CORS=true
CORS_ALLOWED_ORIGINS=*

# Rate limiting
RATE_LIMIT_ENABLE=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000

# File upload limits
MAX_FILE_SIZE=100mb
ALLOWED_FILE_TYPES=pdf,txt,md,json,csv

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE MONITOREO (Opcional)
# -----------------------------------------------------------------------------

# Métricas y logging
ENABLE_METRICS=false
METRICS_PORT=9090
LOG_TO_FILE=false
LOG_FILE_PATH=/var/log/stack-ai.log

# Health checks
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# -----------------------------------------------------------------------------
# NOTAS IMPORTANTES
# -----------------------------------------------------------------------------
#
# 1. MODO LOCAL:
#    - Solo necesitas la configuración básica
#    - Los servicios estarán disponibles en localhost con los puertos especificados
#
# 2. MODO CADDY:
#    - Requiere CLOUDFLARE_DOMAIN y LETSENCRYPT_EMAIL
#    - Caddy manejará SSL automáticamente
#    - Los servicios estarán en https://servicio.tudominio.com
#
# 3. MODO CLOUDFLARE:
#    - Requiere TUNNEL_TOKEN obligatoriamente
#    - Requiere configurar cloudflare/config.yml y credentials.json
#    - Los servicios serán accesibles a través de Cloudflare Tunnel
#
# 4. MODO FULL:
#    - Combina Caddy + Cloudflare
#    - Requiere todas las variables de ambos modos
#    - Máxima flexibilidad de deployment
#
# 5. SEGURIDAD:
#    - Cambia TODAS las contraseñas por valores seguros
#    - Genera claves JWT de al menos 32 caracteres
#    - Nunca commitees este archivo con valores reales
#
# 6. VARIABLES OBLIGATORIAS POR MODO:
#    - local: POSTGRES_PASSWORD, JWT_SECRET, claves de API
#    - caddy: + CLOUDFLARE_DOMAIN, LETSENCRYPT_EMAIL
#    - cloudflare: + TUNNEL_TOKEN
#    - full: todas las anteriores
# =============================================================================